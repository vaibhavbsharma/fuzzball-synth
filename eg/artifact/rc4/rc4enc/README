These experiments correspond to the 'RC4 encryption' subsection of 
Section 4.4 of our ISSTA submission.

We wrap around the RC4 encryption functions in mbedTLS and OpenSSL and 
expose only the RC4 key structures from our wrapper functions. 
The implementation of our target and inner functions can be found 
in f1 and f2.

We describe adaptor synthesis in the two adaptor directions as follows.
Please note that these commands requires LD_LIBRARY_PATH to have the path
to ../lib, for example, 
  LD_LIBRARY_PATH=`pwd`/../../lib/:$LD_LIBRARY_PATH

(1) The command for running this experiment in the mbedTLS <- OpenSSL 
direction is: 
  perl synth-mo-enc.pl 1326 1327 1 1 -1 15
This script runs the binary 'rc4enc_mo', the corresponding source 
code for which can be found in 'rc4enc_mo.c'. This experiment should 
finish in about 2.7 hours. We provide the output generated by this 
experiment in 'synth-mo-enc.log'. 
The last line in this output should be: 
Final adaptors: arg=,, ret=72,, struct=f1_type=0x70000, f1_size=0x2, f1_n=0x4, f2_type=0x801070000, f2_size=0x4, f2_n=0x100

The memory substitution adaptor is to be interpreted as : the 1st 8 
bytes of the inner structure (RC4_KEY) should be copied over from the 
1st 8 bytes in the target structure (mbedtls_arc4_context) as 2 4-byte 
entries with zero extension. Bytes from positions 8 to 1031 in the 
inner structure should be copied over from bytes 8 to 263 in the target 
structure as 256 4-byte entries with zero extension.

(2) The command for running this experiment in the OpenSSL <- mbedTLS 
direction is: 
  perl synth-om-enc.pl 1327 1326 1 1 -1 15
This script runs the binary 'rc4enc_om', the corresponding source code 
for which can be found in 'rc4enc_om.c'. This experiment should finish 
in about 2.7 hours. We provide the output generated by this experiment 
in 'synth-om-enc.log'. The last line in this output should be:
Final adaptors: arg=,, ret=72,, struct=f1_type=0x70001, f1_size=0x1, f1_n=0x8, f2_type=0x804070001, f2_size=0x1, f2_n=0x100,

The memory substitution adaptor is to be interpreted as : the 1st 8 
bytes of the inner structure (mbedtls_arc4_context) should be copied 
over from the 1st 8 bytes in the target structure (RC4_KEY) as 2 4-byte 
entries with zero extension. Bytes from positions 8 to 263 in the 
inner structure should be copied over from bytes 8 to 1031 in the 
target structure as 256 1-byte entries.
